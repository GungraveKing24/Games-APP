{% extends "base.html" %}

{% block title %} Configuración {% endblock title %}

{% block content %}
<div class="flex min-h-screen items-center justify-center bg-gradient-to-br from-indigo-100 to-purple-100 p-4 dark:from-gray-800 dark:to-gray-900">
    <div class="w-full max-w-2xl rounded-lg bg-white p-8 shadow-xl dark:bg-gray-800">

        <div class="flex space-x-4 justify-center"> 
            <!-- Eliminar imágenes -->
            <button type="button" id="ModalDeleteBTN" class="h-10 flex items-center justify-center gap-2 rounded bg-red-600 px-3 py-2 font-semibold text-white transition duration-300 ease-in-out hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600">Eliminar imágenes</button>

            <!-- Subir base de datos -->
            <button id="UploadDB" type="button" class="flex items-center justify-center gap-2 rounded bg-green-600 px-5 py-2 font-semibold text-white transition duration-300 ease-in-out hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600">
                <svg class="h-5 w-5" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10C8 7.79086 9.79086 6 12 6C14.2091 6 16 7.79086 16 10V11H17C18.933 11 20.5 12.567 20.5 14.5C20.5 16.433 18.933 18 17 18H16C15.4477 18 15 18.4477 15 19C15 19.5523 15.4477 20 16 20H17C20.0376 20 22.5 17.5376 22.5 14.5C22.5 11.7793 20.5245 9.51997 17.9296 9.07824C17.4862 6.20213 15.0003 4 12 4C8.99974 4 6.51381 6.20213 6.07036 9.07824C3.47551 9.51997 1.5 11.7793 1.5 14.5C1.5 17.5376 3.96243 20 7 20H8C8.55228 20 9 19.5523 9 19C9 18.4477 8.55228 18 8 18H7C5.067 18 3.5 16.433 3.5 14.5C3.5 12.567 5.067 11 7 11H8V10ZM15.7071 13.2929L12.7071 10.2929C12.3166 9.90237 11.6834 9.90237 11.2929 10.2929L8.29289 13.2929C7.90237 13.6834 7.90237 14.3166 8.29289 14.7071C8.68342 15.0976 9.31658 15.0976 9.70711 14.7071L11 13.4142V19C11 19.5523 11.4477 20 12 20C12.5523 20 13 19.5523 13 19V13.4142L14.2929 14.7071C14.6834 15.0976 15.3166 15.0976 15.7071 14.7071C16.0976 14.3166 16.0976 13.6834 15.7071 13.2929Z" fill="#000000"/>
                </svg>
                <span>Subir DB</span>
            </button>

            <!-- Descargar base de datos -->
            <button id="DownloadDB" type="button" class="h-10 flex items-center justify-center gap-2 rounded bg-blue-600 px-5 py-2 font-semibold text-white transition duration-300 ease-in-out hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600">
                <svg class="h-5 w-5" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10C8 7.79086 9.79086 6 12 6C14.2091 6 16 7.79086 16 10V11H17C18.933 11 20.5 12.567 20.5 14.5C20.5 16.433 18.933 18 17 18H16.9C16.3477 18 15.9 18.4477 15.9 19C15.9 19.5523 16.3477 20 16.9 20H17C20.0376 20 22.5 17.5376 22.5 14.5C22.5 11.7793 20.5245 9.51997 17.9296 9.07824C17.4862 6.20213 15.0003 4 12 4C8.99974 4 6.51381 6.20213 6.07036 9.07824C3.47551 9.51997 1.5 11.7793 1.5 14.5C1.5 17.5376 3.96243 20 7 20H7.1C7.65228 20 8.1 19.5523 8.1 19C8.1 18.4477 7.65228 18 7.1 18H7C5.067 18 3.5 16.433 3.5 14.5C3.5 12.567 5.067 11 7 11H8V10ZM13 11C13 10.4477 12.5523 10 12 10C11.4477 10 11 10.4477 11 11V16.5858L9.70711 15.2929C9.31658 14.9024 8.68342 14.9024 8.29289 15.2929C7.90237 15.6834 7.90237 16.3166 8.29289 16.7071L11.2929 19.7071C11.6834 20.0976 12.3166 20.0976 12.7071 19.7071L15.7071 16.7071C16.0976 16.3166 16.0976 15.6834 15.7071 15.2929C15.3166 14.9024 14.6834 14.9024 14.2929 15.2929L13 16.5858V11Z" fill="#000000"/>
                </svg>
                <span>Descargar DB</span>
            </button>
        </div>

        <!-- Modal para eliminar imágenes -->
        <div id="ModalDelete" class="modal fixed inset-0 z-50 hidden flex items-center justify-center overflow-y-auto">
            <div class="relative max-h-full w-full max-w-2xl overflow-y-auto p-4">
                <div class="relative rounded-lg bg-white shadow dark:bg-gray-700">
                    <div class="flex items-center justify-between rounded-t border-b p-4 md:p-5 dark:border-gray-600">
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Eliminar imágenes</h3>
                        <button type="button" id="CloseModal" class="ms-auto inline-flex h-8 w-8 items-center justify-center rounded-lg bg-transparent text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900 dark:hover:bg-gray-600 dark:hover:text-white">
                            <svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                            </svg>
                            <span class="sr-only">Cerrar modal</span>
                        </button>
                    </div>
                    <div class="max-h-[calc(100vh-200px)] space-y-4 overflow-y-auto p-4 md:p-5">
                        <div id="ModalDeleteContent"></div>
                    </div>
                    <div class="flex items-center rounded-b border-t border-gray-200 p-4 md:p-5 dark:border-gray-600">
                        <button id="ModalDeleteCONFIRM" type="button" class="rounded-lg bg-blue-700 px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700">Confirmar</button>
                        <button id="ModalDeleteCANCEL" type="button" class="ms-3 rounded-lg border border-gray-200 bg-white px-5 py-2.5 text-sm font-medium text-gray-900 hover:bg-gray-100 focus:z-10 focus:outline-none focus:ring-4 dark:border-red-700 dark:bg-red-700 dark:text-white dark:hover:bg-red-800 dark:focus:ring-gray-700">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Credenciales status -->
        <div id="CredentialsStatus" class="mt-4"> 
            <!-- contenido -->
        </div>

        <!-- Dropzone -->
        <div class="mt-4 flex w-full items-center justify-center">
            <label for="dropzone-file" class="flex h-64 w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-gray-500 dark:hover:bg-gray-600 dark:hover:bg-gray-800">
                <div class="flex flex-col items-center justify-center pb-6 pt-5">
                    <svg class="mb-4 h-8 w-8 text-gray-500 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2" />
                    </svg>
                    <p class="mb-2 text-sm text-gray-500 dark:text-white"><span class="font-semibold">Click para subir</span> o arrastra el archivo</p>
                    <p class="text-xs text-gray-500 dark:text-white">JSON (credentials.json)</p>
                </div>
                <input id="dropzone-file" type="file" accept=".json" class="hidden" />
            </label>
        </div>
    </div>
</div>
{% endblock content %}

{% block script %}
<script src="{{ url_for('static', filename='./js/darkmode.js') }}"></script>
<script src="{{ url_for('static', filename='./js/config.js') }}"></script>

<script>
    // Script para verificar si el archivo de credenciales está cargado
    const credentialsStatus = document.getElementById('CredentialsStatus');
    const dropzoneFileInput = document.getElementById('dropzone-file');
    
    function checkCredentials() {
        const file = dropzoneFileInput.files[0];
        if (file && file.name === 'credentials.json') {
            credentialsStatus.innerHTML = 
            '<span class="flex text-green-500 justify-center dark:bg-green-100 rounded-lg px-2 py-1">Credenciales cargadas correctamente</span>';
        } else {
            credentialsStatus.innerHTML = 
            '<span class="flex text-red-500 justify-center dark:bg-red-100 rounded-lg px-2 py-1">Credenciales no cargadas</span>';
        }
    }

    dropzoneFileInput.addEventListener('change', checkCredentials);
    
    // Funciones de botones para subir y bajar la base de datos
    document.getElementById('UploadDB').addEventListener('click', function() {
        alert('Subiendo base de datos...');
        // Agregar lógica para subir la base de datos
    });

    document.getElementById('DownloadDB').addEventListener('click', function() {
        alert('Bajando base de datos...');
        // Agregar lógica para bajar la base de datos
    });
</script>
{% endblock script %}
